{"type":"data","nodes":[{"type":"data","data":[null],"uses":{}},{"type":"data","data":[{"libraryName":1,"itemPath":2,"docItem":3},"sveltejs-sveltekit","best-practices/images",{"type":4,"path":5,"relevant":6,"token_counts":7,"usage":11,"markdown":15},"page","40-best-practices/07-images.md",true,{"fulltext":8,"digest":9,"short_digest":10},3000,756,323,{"input":12,"output":13,"details":14},4043,1211,null,{"fulltext":16,"digest":17,"short_digest":18,"essence":19},"---\ntitle: Images\n---\n\nImages can have a big impact on your app's performance. For best results, you should optimize them by doing the following:\n\n- generate optimal formats like `.avif` and `.webp`\n- create different sizes for different screens\n- ensure that assets can be cached effectively\n\nDoing this manually is tedious. There are a variety of techniques you can use, depending on your needs and preferences.\n\n## Vite's built-in handling\n\n[Vite will automatically process imported assets](https://vitejs.dev/guide/assets.html) for improved performance. This includes assets referenced via the CSS `url()` function. Hashes will be added to the filenames so that they can be cached, and assets smaller than `assetsInlineLimit` will be inlined. Vite's asset handling is most often used for images, but is also useful for video, audio, etc.\n\n```svelte\n\u003Cscript>\n\timport logo from '$lib/assets/logo.png';\n\u003C/script>\n\n\u003Cimg alt=\"The project logo\" src={logo} />\n```\n\n## @sveltejs/enhanced-img\n\n`@sveltejs/enhanced-img` is a plugin offered on top of Vite's built-in asset handling. It provides plug and play image processing that serves smaller file formats like `avif` or `webp`, automatically sets the intrinsic `width` and `height` of the image to avoid layout shift, creates images of multiple sizes for various devices, and strips EXIF data for privacy. It will work in any Vite-based project including, but not limited to, SvelteKit projects.\n\n> [!NOTE] As a build plugin, `@sveltejs/enhanced-img` can only optimize files located on your machine during the build process. If you have an image located elsewhere (such as a path served from your database, CMS, or backend), please read about [loading images dynamically from a CDN](#Loading-images-dynamically-from-a-CDN).\n\n### Setup\n\nInstall:\n\n```sh\nnpm i -D @sveltejs/enhanced-img\n```\n\nAdjust `vite.config.js`:\n\n```js\nimport { sveltekit } from '@sveltejs/kit/vite';\n+++import { enhancedImages } from '@sveltejs/enhanced-img';+++\nimport { defineConfig } from 'vite';\n\nexport default defineConfig({\n\tplugins: [\n\t\t+++enhancedImages(), // must come before the SvelteKit plugin+++\n\t\tsveltekit()\n\t]\n});\n```\n\nBuilding will take longer on the first build due to the computational expense of transforming images. However, the build output will be cached in `./node_modules/.cache/imagetools` so that subsequent builds will be fast.\n\n### Basic usage\n\nUse in your `.svelte` components by using `\u003Cenhanced:img>` rather than `\u003Cimg>` and referencing the image file with a [Vite asset import](https://vitejs.dev/guide/assets.html#static-asset-handling) path:\n\n```svelte\n\u003Cenhanced:img src=\"./path/to/your/image.jpg\" alt=\"An alt text\" />\n```\n\nAt build time, your `\u003Cenhanced:img>` tag will be replaced with an `\u003Cimg>` wrapped by a `\u003Cpicture>` providing multiple image types and sizes. It's only possible to downscale images without losing quality, which means that you should provide the highest resolution image that you need — smaller versions will be generated for the various device types that may request an image.\n\nYou should provide your image at 2x resolution for HiDPI displays (a.k.a. retina displays). `\u003Cenhanced:img>` will automatically take care of serving smaller versions to smaller devices.\n\n> [!NOTE] if you wish to use a [tag name CSS selector](https://developer.mozilla.org/en-US/docs/Learn_web_development/Core/Styling_basics/Basic_selectors#type_selectors) in your `\u003Cstyle>` block you will need to write `enhanced\\:img` to escape the colon in the tag name.\n\n### Dynamically choosing an image\n\nYou can also manually import an image asset and pass it to an `\u003Cenhanced:img>`. This is useful when you have a collection of static images and would like to dynamically choose one or [iterate over them](https://github.com/sveltejs/kit/blob/0ab1733e394b6310895a1d3bf0f126ce34531170/sites/kit.svelte.dev/src/routes/home/Showcase.svelte). In this case you will need to update both the `import` statement and `\u003Cimg>` element as shown below to indicate you'd like process them.\n\n```svelte\n\u003Cscript>\n\timport MyImage from './path/to/your/image.jpg?enhanced';\n\u003C/script>\n\n\u003Cenhanced:img src={MyImage} alt=\"some alt text\" />\n```\n\nYou can also use [Vite's `import.meta.glob`](https://vitejs.dev/guide/features.html#glob-import). Note that you will have to specify `enhanced` via a [custom query](https://vitejs.dev/guide/features.html#custom-queries):\n\n```svelte\n\u003Cscript>\n\tconst imageModules = import.meta.glob(\n\t\t'/path/to/assets/*.{avif,gif,heif,jpeg,jpg,png,tiff,webp,svg}',\n\t\t{\n\t\t\teager: true,\n\t\t\tquery: {\n\t\t\t\tenhanced: true\n\t\t\t}\n\t\t}\n\t)\n\u003C/script>\n\n{#each Object.entries(imageModules) as [_path, module]}\n\t\u003Cenhanced:img src={module.default} alt=\"some alt text\" />\n{/each}\n```\n\n### Intrinsic Dimensions\n\n`width` and `height` are optional as they can be inferred from the source image and will be automatically added when the `\u003Cenhanced:img>` tag is preprocessed. With these attributes, the browser can reserve the correct amount of space, preventing [layout shift](https://web.dev/articles/cls). If you'd like to use a different `width` and `height` you can style the image with CSS. Because the preprocessor adds a `width` and `height` for you, if you'd like one of the dimensions to be automatically calculated then you will need to specify that:\n\n```svelte\n\u003Cstyle>\n\t.hero-image img {\n\t\twidth: var(--size);\n\t\theight: auto;\n\t}\n\u003C/style>\n```\n\n### `srcset` and `sizes`\n\nIf you have a large image, such as a hero image taking the width of the design, you should specify `sizes` so that smaller versions are requested on smaller devices. E.g. if you have a 1280px image you may want to specify something like:\n\n```svelte\n\u003Cenhanced:img src=\"./image.png\" sizes=\"min(1280px, 100vw)\"/>\n```\n\nIf `sizes` is specified, `\u003Cenhanced:img>` will generate small images for smaller devices and populate the `srcset` attribute.\n\nThe smallest picture generated automatically will have a width of 540px. If you'd like smaller images or would otherwise like to specify custom widths, you can do that with the `w` query parameter:\n```svelte\n\u003Cenhanced:img\n  src=\"./image.png?w=1280;640;400\"\n  sizes=\"(min-width:1920px) 1280px, (min-width:1080px) 640px, (min-width:768px) 400px\"\n/>\n```\n\nIf `sizes` is not provided, then a HiDPI/Retina image and a standard resolution image will be generated. The image you provide should be 2x the resolution you wish to display so that the browser can display that image on devices with a high [device pixel ratio](https://developer.mozilla.org/en-US/docs/Web/API/Window/devicePixelRatio).\n\n### Per-image transforms\n\nBy default, enhanced images will be transformed to more efficient formats. However, you may wish to apply other transforms such as a blur, quality, flatten, or rotate operation. You can run per-image transforms by appending a query string:\n\n```svelte\n\u003Cenhanced:img src=\"./path/to/your/image.jpg?blur=15\" alt=\"An alt text\" />\n```\n\n[See the imagetools repo for the full list of directives](https://github.com/JonasKruckenberg/imagetools/blob/main/docs/directives.md).\n\n## Loading images dynamically from a CDN\n\nIn some cases, the images may not be accessible at build time — e.g. they may live inside a content management system or elsewhere.\n\nUsing a content delivery network (CDN) can allow you to optimize these images dynamically, and provides more flexibility with regards to sizes, but it may involve some setup overhead and usage costs. Depending on caching strategy, the browser may not be able to use a cached copy of the asset until a [304 response](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/304) is received from the CDN. Building HTML to target CDNs allows using an `\u003Cimg>` tag since the CDN can serve the appropriate format based on the `User-Agent` header, whereas build-time optimizations must produce `\u003Cpicture>` tags with multiple sources. Finally, some CDNs may generate images lazily, which could have a negative performance impact for sites with low traffic and frequently changing images.\n\nCDNs can generally be used without any need for a library. However, there are a number of libraries with Svelte support that make it easier. [`@unpic/svelte`](https://unpic.pics/img/svelte/) is a CDN-agnostic library with support for a large number of providers. You may also find that specific CDNs like [Cloudinary](https://svelte.cloudinary.dev/) have Svelte support. Finally, some content management systems (CMS) which support Svelte (such as [Contentful](https://www.contentful.com/sveltekit-starter-guide/), [Storyblok](https://github.com/storyblok/storyblok-svelte), and [Contentstack](https://www.contentstack.com/docs/developers/sample-apps/build-a-starter-website-with-sveltekit-and-contentstack)) have built-in support for image handling.\n\n## Best practices\n\n- For each image type, use the appropriate solution from those discussed above. You can mix and match all three solutions in one project. For example, you may use Vite's built-in handling to provide images for `\u003Cmeta>` tags, display images on your homepage with `@sveltejs/enhanced-img`, and display user-submitted content with a dynamic approach.\n- Consider serving all images via CDN regardless of the image optimization types you use. CDNs reduce latency by distributing copies of static assets globally.\n- Your original images should have a good quality/resolution and should have 2x the width it will be displayed at to serve HiDPI devices. Image processing can size images down to save bandwidth when serving smaller screens, but it would be a waste of bandwidth to invent pixels to size images up.\n- For images which are much larger than the width of a mobile device (roughly 400px), such as a hero image taking the width of the page design, specify `sizes` so that smaller images can be served on smaller devices.\n- For important images, such as the [largest contentful paint (LCP)](https://web.dev/articles/lcp) image, set `fetchpriority=\"high\"` and avoid `loading=\"lazy\"` to prioritize loading as early as possible.\n- Give the image a container or styling so that it is constrained and does not jump around while the page is loading affecting your [cumulative layout shift (CLS)](https://web.dev/articles/cls). `width` and `height` help the browser to reserve space while the image is still loading, so `@sveltejs/enhanced-img` will add a `width` and `height` for you.\n- Always provide a good `alt` text. The Svelte compiler will warn you if you don't do this.\n- Do not use `em` or `rem` in `sizes` and change the default size of these measures. When used in `sizes` or `@media` queries, `em` and `rem` are both defined to mean the user's default `font-size`. For a `sizes` declaration like `sizes=\"(min-width: 768px) min(100vw, 108rem), 64rem\"`, the actual `em` or `rem` that controls how the image is laid out on the page can be different if changed by CSS. For example, do not do something like `html { font-size: 62.5%; }` as the slot reserved by the browser preloader will now end up being larger than the actual slot of the CSS object model once it has been created.\n","## Image Optimization Approaches\n\n**Vite's built-in handling**: Automatically processes imported assets, adds hashes for caching, and inlines small assets.\n```svelte\n\u003Cscript>\n\timport logo from '$lib/assets/logo.png';\n\u003C/script>\n\u003Cimg alt=\"The project logo\" src={logo} />\n```\n\n**@sveltejs/enhanced-img**: Build-time plugin that generates optimal formats (avif, webp), creates multiple sizes, sets intrinsic dimensions to prevent layout shift, and strips EXIF data. Only works with local files during build.\n\nSetup:\n```js\nimport { enhancedImages } from '@sveltejs/enhanced-img';\nexport default defineConfig({\n\tplugins: [enhancedImages(), sveltekit()]\n});\n```\n\nUsage with static imports:\n```svelte\n\u003Cenhanced:img src=\"./path/to/your/image.jpg\" alt=\"An alt text\" />\n```\n\nDynamic imports with query parameter:\n```svelte\n\u003Cscript>\n\timport MyImage from './path/to/your/image.jpg?enhanced';\n\u003C/script>\n\u003Cenhanced:img src={MyImage} alt=\"some alt text\" />\n```\n\nOr with glob:\n```svelte\n\u003Cscript>\n\tconst imageModules = import.meta.glob('/path/to/assets/*.{jpg,png}', {\n\t\teager: true,\n\t\tquery: { enhanced: true }\n\t})\n\u003C/script>\n{#each Object.entries(imageModules) as [_path, module]}\n\t\u003Cenhanced:img src={module.default} alt=\"some alt text\" />\n{/each}\n```\n\n**Responsive sizing**: Use `sizes` attribute for large images to serve smaller versions on smaller devices:\n```svelte\n\u003Cenhanced:img src=\"./image.png\" sizes=\"min(1280px, 100vw)\"/>\n```\n\nCustom widths with `w` query parameter:\n```svelte\n\u003Cenhanced:img src=\"./image.png?w=1280;640;400\" sizes=\"(min-width:1920px) 1280px, (min-width:1080px) 640px, (min-width:768px) 400px\"/>\n```\n\n**Per-image transforms**: Apply transforms via query string:\n```svelte\n\u003Cenhanced:img src=\"./path/to/your/image.jpg?blur=15\" alt=\"An alt text\" />\n```\n\n**CDN approach**: For images not available at build time (CMS, database, backend). Use CDN-agnostic libraries like `@unpic/svelte` or provider-specific solutions (Cloudinary, Contentful, Storyblok, Contentstack).\n\n## Best Practices\n\n- Mix approaches in one project as needed\n- Serve all images via CDN to reduce latency\n- Provide images at 2x resolution for HiDPI displays\n- Use `sizes` for images larger than ~400px width\n- Set `fetchpriority=\"high\"` and avoid `loading=\"lazy\"` for LCP images\n- Constrain images with container/styling to prevent layout shift\n- Always provide `alt` text\n- Don't use `em` or `rem` in `sizes` attribute; use absolute units","## Image Optimization\n\n**Vite built-in**: Auto-processes imported assets with hashing and inlining.\n\n**@sveltejs/enhanced-img**: Build-time plugin generating avif/webp formats, multiple sizes, and intrinsic dimensions.\n```svelte\n\u003Cenhanced:img src=\"./image.jpg\" alt=\"text\" />\n```\n\nDynamic imports:\n```svelte\n\u003Cscript>\n\timport MyImage from './image.jpg?enhanced';\n\u003C/script>\n\u003Cenhanced:img src={MyImage} alt=\"text\" />\n```\n\nResponsive sizing:\n```svelte\n\u003Cenhanced:img src=\"./image.png?w=1280;640;400\" sizes=\"(min-width:1920px) 1280px, (min-width:1080px) 640px, (min-width:768px) 400px\"/>\n```\n\nPer-image transforms:\n```svelte\n\u003Cenhanced:img src=\"./image.jpg?blur=15\" alt=\"text\" />\n```\n\n**CDN approach**: For dynamic/external images using `@unpic/svelte` or provider-specific libraries.\n\n**Best practices**: Mix approaches as needed, serve via CDN, provide 2x resolution images, use `sizes` for large images, set `fetchpriority=\"high\"` for LCP images, avoid `em`/`rem` in `sizes`.","Three approaches to image optimization: Vite's built-in asset handling, @sveltejs/enhanced-img for build-time optimization with multiple formats and sizes, and CDN-based solutions for dynamic images."],"uses":{"params":["name","path"]}}]}
