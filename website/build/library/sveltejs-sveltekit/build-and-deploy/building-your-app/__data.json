{"type":"data","nodes":[{"type":"data","data":[null],"uses":{}},{"type":"data","data":[{"libraryName":1,"itemPath":2,"docItem":3},"sveltejs-sveltekit","build-and-deploy/building-your-app",{"type":4,"path":5,"relevant":6,"token_counts":7,"usage":11,"markdown":15},"page","25-build-and-deploy/10-building-your-app.md",true,{"fulltext":8,"digest":9,"short_digest":10},349,267,72,{"input":12,"output":13,"details":14},1398,445,null,{"fulltext":16,"digest":17,"short_digest":18,"essence":19},"---\ntitle: Building your app\n---\n\nBuilding a SvelteKit app happens in two stages, which both happen when you run `vite build` (usually via `npm run build`).\n\nFirstly, Vite creates an optimized production build of your server code, your browser code, and your service worker (if you have one). [Prerendering](page-options#prerender) is executed at this stage, if appropriate.\n\nSecondly, an _adapter_ takes this production build and tunes it for your target environment — more on this on the following pages.\n\n## During the build\n\nSvelteKit will load your `+page/layout(.server).js` files (and all files they import) for analysis during the build. Any code that should _not_ be executed at this stage must check that `building` from [`$app/environment`]($app-environment) is `false`:\n\n```js\n+++import { building } from '$app/environment';+++\nimport { setupMyDatabase } from '$lib/server/database';\n\n+++if (!building) {+++\n\tsetupMyDatabase();\n+++}+++\n\nexport function load() {\n\t// ...\n}\n```\n\n## Preview your app\n\nAfter building, you can view your production build locally with `vite preview` (via `npm run preview`). Note that this will run the app in Node, and so is not a perfect reproduction of your deployed app — adapter-specific adjustments like the [`platform` object](adapters#Platform-specific-context) do not apply to previews.\n","## Build Process\n\nSvelteKit builds happen in two stages via `vite build` (or `npm run build`):\n\n1. **Vite optimization**: Creates optimized production builds of server code, browser code, and service worker. Prerendering executes at this stage if configured.\n2. **Adapter tuning**: An adapter takes the production build and optimizes it for your target environment.\n\n## Avoiding Code Execution During Build\n\nSvelteKit loads `+page/layout(.server).js` files and their imports during the build for analysis. Code that shouldn't execute at build time must check the `building` flag from `$app/environment`:\n\n```js\nimport { building } from '$app/environment';\nimport { setupMyDatabase } from '$lib/server/database';\n\nif (!building) {\n\tsetupMyDatabase();\n}\n\nexport function load() {\n\t// ...\n}\n```\n\n## Preview Your Build\n\nAfter building, preview the production build locally with `vite preview` (or `npm run preview`). This runs in Node and doesn't perfectly reproduce your deployed app — adapter-specific features like the `platform` object don't apply to previews.","SvelteKit builds in two stages: Vite optimizes your code, then an adapter tunes it for your target environment. Prevent code execution during build by checking `building` from `$app/environment`. Preview your build with `vite preview`, though it won't perfectly match your deployed app.","How to build a SvelteKit app and prevent code from running during the build process."],"uses":{"params":["name","path"]}}]}
