{"type":"data","nodes":[{"type":"data","data":[null],"uses":{}},{"type":"data","data":[{"libraryName":1,"itemPath":2,"docItem":3},"sveltejs-sveltekit","advanced-techniques/snapshots",{"type":4,"path":5,"relevant":6,"token_counts":7,"usage":11,"markdown":15},"page","30-advanced/65-snapshots.md",true,{"fulltext":8,"digest":9,"short_digest":10},457,233,95,{"input":12,"output":13,"details":14},1499,432,null,{"fulltext":16,"digest":17,"short_digest":18,"essence":19},"---\ntitle: Snapshots\n---\n\nEphemeral DOM state — like scroll positions on sidebars, the content of `\u003Cinput>` elements and so on — is discarded when you navigate from one page to another.\n\nFor example, if the user fills out a form but navigates away and then back before submitting, or if the user refreshes the page, the values they filled in will be lost. In cases where it's valuable to preserve that input, you can take a _snapshot_ of DOM state, which can then be restored if the user navigates back.\n\nTo do this, export a `snapshot` object with `capture` and `restore` methods from a `+page.svelte` or `+layout.svelte`:\n\n```svelte\n\u003C!--- file: +page.svelte --->\n\u003Cscript>\n\tlet comment = $state('');\n\n\t/** @type {import('./$types').Snapshot\u003Cstring>} */\n\texport const snapshot = {\n\t\tcapture: () => comment,\n\t\trestore: (value) => comment = value\n\t};\n\u003C/script>\n\n\u003Cform method=\"POST\">\n\t\u003Clabel for=\"comment\">Comment\u003C/label>\n\t\u003Ctextarea id=\"comment\" bind:value={comment} />\n\t\u003Cbutton>Post comment\u003C/button>\n\u003C/form>\n```\n\nWhen you navigate away from this page, the `capture` function is called immediately before the page updates, and the returned value is associated with the current entry in the browser's history stack. If you navigate back, the `restore` function is called with the stored value as soon as the page is updated.\n\nThe data must be serializable as JSON so that it can be persisted to `sessionStorage`. This allows the state to be restored when the page is reloaded, or when the user navigates back from a different site.\n\n> [!NOTE] Avoid returning very large objects from `capture` — once captured, objects will be retained in memory for the duration of the session, and in extreme cases may be too large to persist to `sessionStorage`.\n","## Snapshots\n\nPreserve ephemeral DOM state (scroll positions, form input values, etc.) across navigation by exporting a `snapshot` object from `+page.svelte` or `+layout.svelte`.\n\nThe snapshot object must have two methods:\n- `capture()`: Called before navigation, returns the state to preserve\n- `restore(value)`: Called when navigating back, receives the captured state\n\nThe captured data must be JSON-serializable to persist in `sessionStorage`, allowing restoration on page reload or back navigation from external sites.\n\nExample:\n```svelte\n\u003Cscript>\n\tlet comment = $state('');\n\n\t/** @type {import('./$types').Snapshot\u003Cstring>} */\n\texport const snapshot = {\n\t\tcapture: () => comment,\n\t\trestore: (value) => comment = value\n\t};\n\u003C/script>\n\n\u003Ctextarea bind:value={comment} />\n```\n\nAvoid capturing large objects as they remain in memory for the session duration and may exceed `sessionStorage` limits.","Export a `snapshot` object with `capture()` and `restore()` methods from `+page.svelte` or `+layout.svelte` to preserve DOM state across navigation. Data must be JSON-serializable and is stored in `sessionStorage`.\n\n```svelte\nexport const snapshot = {\n\tcapture: () => state,\n\trestore: (value) => state = value\n};\n```","Preserve ephemeral DOM state across navigation using snapshot capture and restore methods."],"uses":{"params":["name","path"]}}]}
