<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../../../favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../../../_app/immutable/assets/0.CVnJD79Y.css" rel="stylesheet">
		<link rel="modulepreload" href="../../../_app/immutable/entry/start.BUjidAzk.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/CAE4LXnd.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/Bqk6hhwi.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/tx92N3wN.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/BQJvaCje.js">
		<link rel="modulepreload" href="../../../_app/immutable/entry/app.Bxb7igFF.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/PPVm8Dsz.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/DZAWgNcB.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/Cx74nDeh.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/CzwVlzDJ.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/BYVsYXjt.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/0.u3QdgOnm.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/BBIV77v4.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/2renQMhh.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/4.GQEmuTpV.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/Dw3jGaj_.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/oC0O2L-Y.js"><!--1funsus--><!--[!--><!--]--> <!----><script>(function setInitialMode({ defaultMode = "system", themeColors: themeColors2, darkClassNames: darkClassNames2 = ["dark"], lightClassNames: lightClassNames2 = [], defaultTheme = "", modeStorageKey: modeStorageKey2 = "mode-watcher-mode", themeStorageKey: themeStorageKey2 = "mode-watcher-theme" }) {
  const rootEl = document.documentElement;
  const mode = localStorage.getItem(modeStorageKey2) ?? defaultMode;
  const theme = localStorage.getItem(themeStorageKey2) ?? defaultTheme;
  const light = mode === "light" || mode === "system" && window.matchMedia("(prefers-color-scheme: light)").matches;
  if (light) {
    if (darkClassNames2.length)
      rootEl.classList.remove(...darkClassNames2.filter(Boolean));
    if (lightClassNames2.length)
      rootEl.classList.add(...lightClassNames2.filter(Boolean));
  } else {
    if (lightClassNames2.length)
      rootEl.classList.remove(...lightClassNames2.filter(Boolean));
    if (darkClassNames2.length)
      rootEl.classList.add(...darkClassNames2.filter(Boolean));
  }
  rootEl.style.colorScheme = light ? "light" : "dark";
  if (themeColors2) {
    const themeMetaEl = document.querySelector('meta[name="theme-color"]');
    if (themeMetaEl) {
      themeMetaEl.setAttribute("content", mode === "light" ? themeColors2.light : themeColors2.dark);
    }
  }
  if (theme) {
    rootEl.setAttribute("data-theme", theme);
    localStorage.setItem(themeStorageKey2, theme);
  }
  localStorage.setItem(modeStorageKey2, mode);
})({"defaultMode":"system","darkClassNames":["dark"],"lightClassNames":[],"defaultTheme":"","modeStorageKey":"mode-watcher-mode","themeStorageKey":"mode-watcher-theme"});</script><!----><!---->
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!----><!--[!--><!--]--><!----> <!----><div class="container mx-auto px-4 py-8 max-w-6xl"><div class="flex items-center justify-between mb-6"><nav class="flex items-center gap-2 text-sm text-muted-foreground"><a href="../../../" class="hover:text-foreground transition-colors">Home</a> <span>/</span> <a href="../../../library/sveltejs-sveltekit" class="hover:text-foreground transition-colors">sveltejs-sveltekit</a> <span>/</span> <!--[--><!--[!--><!--]--> <!--[!--><a href="../../../library/sveltejs-sveltekit/core-concepts" class="hover:text-foreground transition-colors">core-concepts</a><!--]--><!--[--><span>/</span><!--]--> <!--[--><span class="text-foreground">form-actions</span><!--]--><!--]--></nav> <div class="flex items-center gap-2"><a href="https://github.com/xl0/lovely-docs" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><!--[!--><button data-slot="button" class="focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive inline-flex shrink-0 items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium outline-none transition-all focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;_svg:not([class*='size-'])]:size-4 [&amp;_svg]:pointer-events-none [&amp;_svg]:shrink-0 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 border size-9" type="button"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-github"><!--[--><!----><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"><!----></path><!----><!----><path d="M9 18c-4.51 2-5-2-7-2"><!----></path><!----><!--]--><!----><!----></svg><!----></button><!--]--><!----></a> <!--[!--><button data-slot="button" class="focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive inline-flex shrink-0 items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium outline-none transition-all focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;_svg:not([class*='size-'])]:size-4 [&amp;_svg]:pointer-events-none [&amp;_svg]:shrink-0 hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 size-9" type="button" aria-label="Toggle theme"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><!----></button><!--]--><!----></div></div> <div class="mb-6"><div class="flex items-center justify-between mb-2"><h1 class="text-3xl font-bold tracking-tight">form-actions</h1> <!----><span data-slot="badge" class="focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive inline-flex w-fit shrink-0 items-center justify-center gap-1 overflow-hidden whitespace-nowrap rounded-full border px-2 py-0.5 text-xs font-medium transition-[color,box-shadow] focus-visible:ring-[3px] [&amp;>svg]:pointer-events-none [&amp;>svg]:size-3 bg-primary text-primary-foreground [a&amp;]:hover:bg-primary/90 border-transparent"><!---->✓ Relevant<!----><!----></span><!----><!----></div> <p class="text-sm text-muted-foreground font-mono">Path: 20-core-concepts/30-form-actions.md</p> <!--[--><div class="mt-3 text-sm text-muted-foreground italic border-l-2 border-muted pl-3">Server-side form actions in +page.server.js handle POST requests with progressive enhancement support via use:enhance.</div><!--]--></div> <div data-slot="card" class="bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm mb-6"><div data-slot="card-content" class="px-6"><div class="flex items-center justify-between gap-4"><div class="flex flex-wrap gap-2"><!--[--><!--[!--><button data-slot="button" class="focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive inline-flex shrink-0 items-center justify-center whitespace-nowrap text-sm font-medium outline-none transition-all focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;_svg:not([class*='size-'])]:size-4 [&amp;_svg]:pointer-events-none [&amp;_svg]:shrink-0 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 border h-8 gap-1.5 rounded-md px-3 has-[>svg]:px-2.5" type="button"><!---->Full Text <!--[--><!--[--><span class="ml-1 text-xs opacity-70">(5,128 tok)</span><!--]--><!--]--><!----></button><!--]--><!--[!--><button data-slot="button" class="focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive inline-flex shrink-0 items-center justify-center whitespace-nowrap text-sm font-medium outline-none transition-all focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;_svg:not([class*='size-'])]:size-4 [&amp;_svg]:pointer-events-none [&amp;_svg]:shrink-0 bg-primary text-primary-foreground shadow-xs hover:bg-primary/90 h-8 gap-1.5 rounded-md px-3 has-[>svg]:px-2.5" type="button"><!---->Digest <!--[--><!--[!--><!--[--><span class="ml-1 text-xs opacity-70">(17%)</span><!--]--><!--]--><!--]--><!----></button><!--]--><!--[!--><button data-slot="button" class="focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive inline-flex shrink-0 items-center justify-center whitespace-nowrap text-sm font-medium outline-none transition-all focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;_svg:not([class*='size-'])]:size-4 [&amp;_svg]:pointer-events-none [&amp;_svg]:shrink-0 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 border h-8 gap-1.5 rounded-md px-3 has-[>svg]:px-2.5" type="button"><!---->Short Digest <!--[--><!--[!--><!--[!--><!--[--><span class="ml-1 text-xs opacity-70">(6%)</span><!--]--><!--]--><!--]--><!--]--><!----></button><!--]--><!--]--></div> <!--[!--><button data-slot="button" class="focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive inline-flex shrink-0 items-center justify-center whitespace-nowrap text-sm font-medium outline-none transition-all focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&amp;_svg:not([class*='size-'])]:size-4 [&amp;_svg]:pointer-events-none [&amp;_svg]:shrink-0 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 border h-8 gap-1.5 rounded-md px-3 has-[>svg]:px-2.5" type="button"><!---->Markdown<!----></button><!--]--><!----></div><!----></div><!----></div><!----> <div data-slot="card" class="bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm"><div data-slot="card-content" class="px-6 pt-6"><!--[--><!--[!--><div class="prose prose-slate dark:prose-invert max-w-none"><!----><!----></div><!--]--><!--]--><!----></div><!----></div><!----></div><!----><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_rfwywu = {
						base: new URL("../../..", location).pathname.slice(0, -1),
						assets: "/lovely-docs"
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../../../_app/immutable/entry/start.BUjidAzk.js"),
						import("../../../_app/immutable/entry/app.Bxb7igFF.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 4],
							data: [{type:"data",data:null,uses:{}},{type:"data",data:{libraryName:"sveltejs-sveltekit",itemPath:"core-concepts/form-actions",docItem:{type:"page",path:"20-core-concepts/30-form-actions.md",relevant:true,token_counts:{fulltext:5128,digest:857,short_digest:319},usage:{input:6173,output:1286,details:null},markdown:{fulltext:"---\ntitle: Form actions\n---\n\nA `+page.server.js` file can export _actions_, which allow you to `POST` data to the server using the `\u003Cform>` element.\n\nWhen using `\u003Cform>`, client-side JavaScript is optional, but you can easily _progressively enhance_ your form interactions with JavaScript to provide the best user experience.\n\n## Default actions\n\nIn the simplest case, a page declares a `default` action:\n\n```js\n/// file: src/routes/login/+page.server.js\n/** @satisfies {import('./$types').Actions} */\nexport const actions = {\n\tdefault: async (event) => {\n\t\t// TODO log the user in\n\t}\n};\n```\n\nTo invoke this action from the `/login` page, just add a `\u003Cform>` — no JavaScript needed:\n\n```svelte\n\u003C!--- file: src/routes/login/+page.svelte --->\n\u003Cform method=\"POST\">\n\t\u003Clabel>\n\t\tEmail\n\t\t\u003Cinput name=\"email\" type=\"email\">\n\t\u003C/label>\n\t\u003Clabel>\n\t\tPassword\n\t\t\u003Cinput name=\"password\" type=\"password\">\n\t\u003C/label>\n\t\u003Cbutton>Log in\u003C/button>\n\u003C/form>\n```\n\nIf someone were to click the button, the browser would send the form data via `POST` request to the server, running the default action.\n\n> [!NOTE] Actions always use `POST` requests, since `GET` requests should never have side-effects.\n\nWe can also invoke the action from other pages (for example if there's a login widget in the nav in the root layout) by adding the `action` attribute, pointing to the page:\n\n```html\n/// file: src/routes/+layout.svelte\n\u003Cform method=\"POST\" action=\"/login\">\n\t\u003C!-- content -->\n\u003C/form>\n```\n\n## Named actions\n\nInstead of one `default` action, a page can have as many named actions as it needs:\n\n```js\n/// file: src/routes/login/+page.server.js\n/** @satisfies {import('./$types').Actions} */\nexport const actions = {\n---\tdefault: async (event) => {---\n+++\tlogin: async (event) => {+++\n\t\t// TODO log the user in\n\t},\n+++\tregister: async (event) => {\n\t\t// TODO register the user\n\t}+++\n};\n```\n\nTo invoke a named action, add a query parameter with the name prefixed by a `/` character:\n\n```svelte\n\u003C!--- file: src/routes/login/+page.svelte --->\n\u003Cform method=\"POST\" action=\"?/register\">\n```\n\n```svelte\n\u003C!--- file: src/routes/+layout.svelte --->\n\u003Cform method=\"POST\" action=\"/login?/register\">\n```\n\nAs well as the `action` attribute, we can use the `formaction` attribute on a button to `POST` the same form data to a different action than the parent `\u003Cform>`:\n\n```svelte\n/// file: src/routes/login/+page.svelte\n\u003Cform method=\"POST\" +++action=\"?/login\"+++>\n\t\u003Clabel>\n\t\tEmail\n\t\t\u003Cinput name=\"email\" type=\"email\">\n\t\u003C/label>\n\t\u003Clabel>\n\t\tPassword\n\t\t\u003Cinput name=\"password\" type=\"password\">\n\t\u003C/label>\n\t\u003Cbutton>Log in\u003C/button>\n\t+++\u003Cbutton formaction=\"?/register\">Register\u003C/button>+++\n\u003C/form>\n```\n\n> [!NOTE] We can't have default actions next to named actions, because if you POST to a named action without a redirect, the query parameter is persisted in the URL, which means the next default POST would go through the named action from before.\n\n## Anatomy of an action\n\nEach action receives a `RequestEvent` object, allowing you to read the data with `request.formData()`. After processing the request (for example, logging the user in by setting a cookie), the action can respond with data that will be available through the `form` property on the corresponding page and through `page.form` app-wide until the next update.\n\n```js\n/// file: src/routes/login/+page.server.js\n// @filename: ambient.d.ts\ndeclare module '$lib/server/db';\n\n// @filename: index.js\n// ---cut---\nimport * as db from '$lib/server/db';\n\n/** @type {import('./$types').PageServerLoad} */\nexport async function load({ cookies }) {\n\tconst user = await db.getUserFromSession(cookies.get('sessionid'));\n\treturn { user };\n}\n\n/** @satisfies {import('./$types').Actions} */\nexport const actions = {\n\tlogin: async ({ cookies, request }) => {\n\t\tconst data = await request.formData();\n\t\tconst email = data.get('email');\n\t\tconst password = data.get('password');\n\n\t\tconst user = await db.getUser(email);\n\t\tcookies.set('sessionid', await db.createSession(user), { path: '/' });\n\n\t\treturn { success: true };\n\t},\n\tregister: async (event) => {\n\t\t// TODO register the user\n\t}\n};\n```\n\n```svelte\n\u003C!--- file: src/routes/login/+page.svelte --->\n\u003Cscript>\n\t/** @type {import('./$types').PageProps} */\n\tlet { data, form } = $props();\n\u003C/script>\n\n{#if form?.success}\n\t\u003C!-- this message is ephemeral; it exists because the page was rendered in\n\t       response to a form submission. it will vanish if the user reloads -->\n\t\u003Cp>Successfully logged in! Welcome back, {data.user.name}\u003C/p>\n{/if}\n```\n\n> [!LEGACY]\n> `PageProps` was added in 2.16.0. In earlier versions, you had to type the `data` and `form` properties individually:\n> ```js\n> /// file: +page.svelte\n> /** @type {{ data: import('./$types').PageData, form: import('./$types').ActionData }} */\n> let { data, form } = $props();\n> ```\n>\n> In Svelte 4, you'd use `export let data` and `export let form` instead to declare properties.\n\n### Validation errors\n\nIf the request couldn't be processed because of invalid data, you can return validation errors — along with the previously submitted form values — back to the user so that they can try again. The `fail` function lets you return an HTTP status code (typically 400 or 422, in the case of validation errors) along with the data. The status code is available through `page.status` and the data through `form`:\n\n```js\n/// file: src/routes/login/+page.server.js\n// @filename: ambient.d.ts\ndeclare module '$lib/server/db';\n\n// @filename: index.js\n// ---cut---\n+++import { fail } from '@sveltejs/kit';+++\nimport * as db from '$lib/server/db';\n\n/** @satisfies {import('./$types').Actions} */\nexport const actions = {\n\tlogin: async ({ cookies, request }) => {\n\t\tconst data = await request.formData();\n\t\tconst email = data.get('email');\n\t\tconst password = data.get('password');\n\n+++\t\tif (!email) {\n\t\t\treturn fail(400, { email, missing: true });\n\t\t}+++\n\n\t\tconst user = await db.getUser(email);\n\n+++\t\tif (!user || user.password !== db.hash(password)) {\n\t\t\treturn fail(400, { email, incorrect: true });\n\t\t}+++\n\n\t\tcookies.set('sessionid', await db.createSession(user), { path: '/' });\n\n\t\treturn { success: true };\n\t},\n\tregister: async (event) => {\n\t\t// TODO register the user\n\t}\n};\n```\n\n> [!NOTE] Note that as a precaution, we only return the email back to the page — not the password.\n\n```svelte\n/// file: src/routes/login/+page.svelte\n\u003Cform method=\"POST\" action=\"?/login\">\n+++\t{#if form?.missing}\u003Cp class=\"error\">The email field is required\u003C/p>{/if}\n\t{#if form?.incorrect}\u003Cp class=\"error\">Invalid credentials!\u003C/p>{/if}+++\n\t\u003Clabel>\n\t\tEmail\n\t\t\u003Cinput name=\"email\" type=\"email\" +++value={form?.email ?? ''}+++>\n\t\u003C/label>\n\t\u003Clabel>\n\t\tPassword\n\t\t\u003Cinput name=\"password\" type=\"password\">\n\t\u003C/label>\n\t\u003Cbutton>Log in\u003C/button>\n\t\u003Cbutton formaction=\"?/register\">Register\u003C/button>\n\u003C/form>\n```\n\nThe returned data must be serializable as JSON. Beyond that, the structure is entirely up to you. For example, if you had multiple forms on the page, you could distinguish which `\u003Cform>` the returned `form` data referred to with an `id` property or similar.\n\n### Redirects\n\nRedirects (and errors) work exactly the same as in [`load`](load#Redirects):\n\n```js\n// @errors: 2345\n/// file: src/routes/login/+page.server.js\n// @filename: ambient.d.ts\ndeclare module '$lib/server/db';\n\n// @filename: index.js\n// ---cut---\nimport { fail, +++redirect+++ } from '@sveltejs/kit';\nimport * as db from '$lib/server/db';\n\n/** @satisfies {import('./$types').Actions} */\nexport const actions = {\n\tlogin: async ({ cookies, request, +++url+++ }) => {\n\t\tconst data = await request.formData();\n\t\tconst email = data.get('email');\n\t\tconst password = data.get('password');\n\n\t\tconst user = await db.getUser(email);\n\t\tif (!user) {\n\t\t\treturn fail(400, { email, missing: true });\n\t\t}\n\n\t\tif (user.password !== db.hash(password)) {\n\t\t\treturn fail(400, { email, incorrect: true });\n\t\t}\n\n\t\tcookies.set('sessionid', await db.createSession(user), { path: '/' });\n\n+++\t\tif (url.searchParams.has('redirectTo')) {\n\t\t\tredirect(303, url.searchParams.get('redirectTo'));\n\t\t}+++\n\n\t\treturn { success: true };\n\t},\n\tregister: async (event) => {\n\t\t// TODO register the user\n\t}\n};\n```\n\n## Loading data\n\nAfter an action runs, the page will be re-rendered (unless a redirect or an unexpected error occurs), with the action's return value available to the page as the `form` prop. This means that your page's `load` functions will run after the action completes.\n\nNote that `handle` runs before the action is invoked, and does not rerun before the `load` functions. This means that if, for example, you use `handle` to populate `event.locals` based on a cookie, you must update `event.locals` when you set or delete the cookie in an action:\n\n```js\n/// file: src/hooks.server.js\n// @filename: ambient.d.ts\ndeclare namespace App {\n\tinterface Locals {\n\t\tuser: {\n\t\t\tname: string;\n\t\t} | null\n\t}\n}\n\n// @filename: global.d.ts\ndeclare global {\n\tfunction getUser(sessionid: string | undefined): {\n\t\tname: string;\n\t};\n}\n\nexport {};\n\n// @filename: index.js\n// ---cut---\n/** @type {import('@sveltejs/kit').Handle} */\nexport async function handle({ event, resolve }) {\n\tevent.locals.user = await getUser(event.cookies.get('sessionid'));\n\treturn resolve(event);\n}\n```\n\n```js\n/// file: src/routes/account/+page.server.js\n// @filename: ambient.d.ts\ndeclare namespace App {\n\tinterface Locals {\n\t\tuser: {\n\t\t\tname: string;\n\t\t} | null\n\t}\n}\n\n// @filename: index.js\n// ---cut---\n/** @type {import('./$types').PageServerLoad} */\nexport function load(event) {\n\treturn {\n\t\tuser: event.locals.user\n\t};\n}\n\n/** @satisfies {import('./$types').Actions} */\nexport const actions = {\n\tlogout: async (event) => {\n\t\tevent.cookies.delete('sessionid', { path: '/' });\n\t\tevent.locals.user = null;\n\t}\n};\n```\n\n## Progressive enhancement\n\nIn the preceding sections we built a `/login` action that [works without client-side JavaScript](https://kryogenix.org/code/browser/everyonehasjs.html) — not a `fetch` in sight. That's great, but when JavaScript _is_ available we can progressively enhance our form interactions to provide a better user experience.\n\n### use:enhance\n\nThe easiest way to progressively enhance a form is to add the `use:enhance` action:\n\n```svelte\n/// file: src/routes/login/+page.svelte\n\u003Cscript>\n\t+++import { enhance } from '$app/forms';+++\n\n\t/** @type {import('./$types').PageProps} */\n\tlet { form } = $props();\n\u003C/script>\n\n\u003Cform method=\"POST\" +++use:enhance+++>\n```\n\n> [!NOTE] `use:enhance` can only be used with forms that have `method=\"POST\"` and point to actions defined in a `+page.server.js` file. It will not work with `method=\"GET\"`, which is the default for forms without a specified method. Attempting to use `use:enhance` on forms without `method=\"POST\"` or posting to a `+server.js` endpoint will result in an error.\n\n> [!NOTE] Yes, it's a little confusing that the `enhance` action and `\u003Cform action>` are both called 'action'. These docs are action-packed. Sorry.\n\nWithout an argument, `use:enhance` will emulate the browser-native behaviour, just without the full-page reloads. It will:\n\n- update the `form` property, `page.form` and `page.status` on a successful or invalid response, but only if the action is on the same page you're submitting from. For example, if your form looks like `\u003Cform action=\"/somewhere/else\" ..>`, the `form` prop and the `page.form` state will _not_ be updated. This is because in the native form submission case you would be redirected to the page the action is on. If you want to have them updated either way, use [`applyAction`](#Progressive-enhancement-Customising-use:enhance)\n- reset the `\u003Cform>` element\n- invalidate all data using `invalidateAll` on a successful response\n- call `goto` on a redirect response\n- render the nearest `+error` boundary if an error occurs\n- [reset focus](accessibility#Focus-management) to the appropriate element\n\n### Customising use:enhance\n\nTo customise the behaviour, you can provide a `SubmitFunction` that runs immediately before the form is submitted, and (optionally) returns a callback that runs with the `ActionResult`.\n\n```svelte\n\u003Cform\n\tmethod=\"POST\"\n\tuse:enhance={({ formElement, formData, action, cancel, submitter }) => {\n\t\t// `formElement` is this `\u003Cform>` element\n\t\t// `formData` is its `FormData` object that's about to be submitted\n\t\t// `action` is the URL to which the form is posted\n\t\t// calling `cancel()` will prevent the submission\n\t\t// `submitter` is the `HTMLElement` that caused the form to be submitted\n\n\t\treturn async ({ result, update }) => {\n\t\t\t// `result` is an `ActionResult` object\n\t\t\t// `update` is a function which triggers the default logic that would be triggered if this callback wasn't set\n\t\t};\n\t}}\n>\n```\n\nYou can use these functions to show and hide loading UI, and so on.\n\nIf you return a callback, you override the default post-submission behavior. To get it back, call `update`, which accepts `invalidateAll` and `reset` parameters, or use `applyAction` on the result:\n\n```svelte\n/// file: src/routes/login/+page.svelte\n\u003Cscript>\n\timport { enhance, +++applyAction+++ } from '$app/forms';\n\n\t/** @type {import('./$types').PageProps} */\n\tlet { form } = $props();\n\u003C/script>\n\n\u003Cform\n\tmethod=\"POST\"\n\tuse:enhance={({ formElement, formData, action, cancel }) => {\n\t\treturn async ({ result }) => {\n\t\t\t// `result` is an `ActionResult` object\n+++\t\t\tif (result.type === 'redirect') {\n\t\t\t\tgoto(result.location);\n\t\t\t} else {\n\t\t\t\tawait applyAction(result);\n\t\t\t}+++\n\t\t};\n\t}}\n>\n```\n\nThe behaviour of `applyAction(result)` depends on `result.type`:\n\n- `success`, `failure` — sets `page.status` to `result.status` and updates `form` and `page.form` to `result.data` (regardless of where you are submitting from, in contrast to `update` from `enhance`)\n- `redirect` — calls `goto(result.location, { invalidateAll: true })`\n- `error` — renders the nearest `+error` boundary with `result.error`\n\nIn all cases, [focus will be reset](accessibility#Focus-management).\n\n### Custom event listener\n\nWe can also implement progressive enhancement ourselves, without `use:enhance`, with a normal event listener on the `\u003Cform>`:\n\n```svelte\n\u003C!--- file: src/routes/login/+page.svelte --->\n\u003Cscript>\n\timport { invalidateAll, goto } from '$app/navigation';\n\timport { applyAction, deserialize } from '$app/forms';\n\n\t/** @type {import('./$types').PageProps} */\n\tlet { form } = $props();\n\n\t/** @param {SubmitEvent & { currentTarget: EventTarget & HTMLFormElement}} event */\n\tasync function handleSubmit(event) {\n\t\tevent.preventDefault();\n\t\tconst data = new FormData(event.currentTarget, event.submitter);\n\n\t\tconst response = await fetch(event.currentTarget.action, {\n\t\t\tmethod: 'POST',\n\t\t\tbody: data\n\t\t});\n\n\t\t/** @type {import('@sveltejs/kit').ActionResult} */\n\t\tconst result = deserialize(await response.text());\n\n\t\tif (result.type === 'success') {\n\t\t\t// rerun all `load` functions, following the successful update\n\t\t\tawait invalidateAll();\n\t\t}\n\n\t\tapplyAction(result);\n\t}\n\u003C/script>\n\n\u003Cform method=\"POST\" onsubmit={handleSubmit}>\n\t\u003C!-- content -->\n\u003C/form>\n```\n\nNote that you need to `deserialize` the response before processing it further using the corresponding method from `$app/forms`. `JSON.parse()` isn't enough because form actions - like `load` functions - also support returning `Date` or `BigInt` objects.\n\nIf you have a `+server.js` alongside your `+page.server.js`, `fetch` requests will be routed there by default. To `POST` to an action in `+page.server.js` instead, use the custom `x-sveltekit-action` header:\n\n```js\n// @errors: 2532 2304\nconst response = await fetch(this.action, {\n\tmethod: 'POST',\n\tbody: data,\n+++\theaders: {\n\t\t'x-sveltekit-action': 'true'\n\t}+++\n});\n```\n\n## Alternatives\n\nForm actions are the preferred way to send data to the server, since they can be progressively enhanced, but you can also use [`+server.js`](routing#server) files to expose (for example) a JSON API. Here's how such an interaction could look like:\n\n```svelte\n\u003C!--- file: src/routes/send-message/+page.svelte --->\n\u003Cscript>\n\tfunction rerun() {\n\t\tfetch('/api/ci', {\n\t\t\tmethod: 'POST'\n\t\t});\n\t}\n\u003C/script>\n\n\u003Cbutton onclick={rerun}>Rerun CI\u003C/button>\n```\n\n```js\n// @errors: 2355 1360 2322\n/// file: src/routes/api/ci/+server.js\n/** @type {import('./$types').RequestHandler} */\nexport function POST() {\n\t// do something\n}\n```\n\n## GET vs POST\n\nAs we've seen, to invoke a form action you must use `method=\"POST\"`.\n\nSome forms don't need to `POST` data to the server — search inputs, for example. For these you can use `method=\"GET\"` (or, equivalently, no `method` at all), and SvelteKit will treat them like `\u003Ca>` elements, using the client-side router instead of a full page navigation:\n\n```html\n\u003Cform action=\"/search\">\n\t\u003Clabel>\n\t\tSearch\n\t\t\u003Cinput name=\"q\">\n\t\u003C/label>\n\u003C/form>\n```\n\nSubmitting this form will navigate to `/search?q=...` and invoke your load function but will not invoke an action. As with `\u003Ca>` elements, you can set the [`data-sveltekit-reload`](link-options#data-sveltekit-reload), [`data-sveltekit-replacestate`](link-options#data-sveltekit-replacestate), [`data-sveltekit-keepfocus`](link-options#data-sveltekit-keepfocus) and [`data-sveltekit-noscroll`](link-options#data-sveltekit-noscroll) attributes on the `\u003Cform>` to control the router's behaviour.\n\n## Further reading\n\n- [Tutorial: Forms](/tutorial/kit/the-form-element)\n",digest:"## Default Actions\n\nExport an `actions` object with a `default` action from `+page.server.js` to handle form submissions:\n\n```js\nexport const actions = {\n\tdefault: async (event) => {\n\t\t// handle POST\n\t}\n};\n```\n\nUse a `\u003Cform method=\"POST\">` to invoke it. The action receives a `RequestEvent` and can read form data via `request.formData()`.\n\n## Named Actions\n\nDefine multiple named actions instead of a default:\n\n```js\nexport const actions = {\n\tlogin: async (event) => {},\n\tregister: async (event) => {}\n};\n```\n\nInvoke with query parameters: `\u003Cform method=\"POST\" action=\"?/login\">` or use `formaction` on buttons: `\u003Cbutton formaction=\"?/register\">`.\n\nCannot mix default and named actions on the same page.\n\n## Returning Data\n\nActions return data available as the `form` prop on the page:\n\n```js\nexport const actions = {\n\tlogin: async ({ cookies, request }) => {\n\t\tconst data = await request.formData();\n\t\tconst email = data.get('email');\n\t\tcookies.set('sessionid', await db.createSession(user), { path: '/' });\n\t\treturn { success: true };\n\t}\n};\n```\n\n```svelte\n{#if form?.success}\n\t\u003Cp>Successfully logged in!\u003C/p>\n{/if}\n```\n\n## Validation Errors\n\nUse the `fail` function to return HTTP status codes with validation errors:\n\n```js\nimport { fail } from '@sveltejs/kit';\n\nexport const actions = {\n\tlogin: async ({ request }) => {\n\t\tconst data = await request.formData();\n\t\tconst email = data.get('email');\n\t\tif (!email) {\n\t\t\treturn fail(400, { email, missing: true });\n\t\t}\n\t}\n};\n```\n\n```svelte\n{#if form?.missing}\u003Cp class=\"error\">Email required\u003C/p>{/if}\n\u003Cinput value={form?.email ?? ''}>\n```\n\n## Redirects\n\nUse the `redirect` function to redirect after successful action:\n\n```js\nimport { redirect } from '@sveltejs/kit';\n\nexport const actions = {\n\tlogin: async ({ cookies, request, url }) => {\n\t\t// ... login logic\n\t\tif (url.searchParams.has('redirectTo')) {\n\t\t\tredirect(303, url.searchParams.get('redirectTo'));\n\t\t}\n\t\treturn { success: true };\n\t}\n};\n```\n\n## Progressive Enhancement\n\nAdd `use:enhance` to progressively enhance forms without full-page reloads:\n\n```svelte\n\u003Cscript>\n\timport { enhance } from '$app/forms';\n\u003C/script>\n\n\u003Cform method=\"POST\" use:enhance>\n```\n\nCustomize behavior with a `SubmitFunction`:\n\n```svelte\n\u003Cform method=\"POST\" use:enhance={({ formData, cancel }) => {\n\treturn async ({ result }) => {\n\t\tif (result.type === 'redirect') {\n\t\t\tgoto(result.location);\n\t\t} else {\n\t\t\tawait applyAction(result);\n\t\t}\n\t};\n}>\n```\n\nUse `applyAction` to manually handle results. Use `deserialize` when implementing custom event listeners with `fetch`.\n\n## Loading Data\n\nPage `load` functions run after actions complete. If using `handle` to populate `event.locals` from cookies, manually update `event.locals` when setting/deleting cookies in actions.\n\n## GET vs POST\n\nUse `method=\"POST\"` for actions. Use `method=\"GET\"` for search/filter forms—these invoke `load` functions but not actions, and use client-side routing.",short_digest:"## Form Actions Basics\n\nExport `actions` from `+page.server.js` to handle POST requests:\n\n```js\nexport const actions = {\n\tdefault: async (event) => {},\n\tlogin: async (event) => {},\n\tregister: async (event) => {}\n};\n```\n\nInvoke with `\u003Cform method=\"POST\" action=\"?/login\">` or `\u003Cbutton formaction=\"?/register\">`.\n\n## Handling Data & Errors\n\nRead form data and return results:\n\n```js\nexport const actions = {\n\tlogin: async ({ request }) => {\n\t\tconst data = await request.formData();\n\t\tif (!data.get('email')) {\n\t\t\treturn fail(400, { missing: true });\n\t\t}\n\t\treturn { success: true };\n\t}\n};\n```\n\nAccess in component via `form` prop. Use `redirect()` for redirects.\n\n## Progressive Enhancement\n\nAdd `use:enhance` for client-side form handling without full-page reloads:\n\n```svelte\n\u003Cscript>\n\timport { enhance, applyAction } from '$app/forms';\n\u003C/script>\n\n\u003Cform method=\"POST\" use:enhance={({ formData }) => {\n\treturn async ({ result }) => {\n\t\tawait applyAction(result);\n\t};\n}>\n```\n\nUse `deserialize` when implementing custom fetch-based handlers.",essence:"Server-side form actions in +page.server.js handle POST requests with progressive enhancement support via use:enhance."}}},uses:{params:["name","path"]}}],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
