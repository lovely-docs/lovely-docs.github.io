{"type":"data","nodes":[{"type":"data","data":[null],"uses":{}},{"type":"data","data":[{"libraryName":1,"itemPath":2,"docItem":3},"sveltejs-sveltekit","advanced-techniques/server-only-modules",{"type":4,"path":5,"relevant":6,"token_counts":7,"usage":11,"markdown":15},"page","30-advanced/50-server-only-modules.md",true,{"fulltext":8,"digest":9,"short_digest":10},721,362,65,{"input":12,"output":13,"details":14},1766,546,null,{"fulltext":16,"digest":17,"short_digest":18,"essence":19},"---\ntitle: Server-only modules\n---\n\nLike a good friend, SvelteKit keeps your secrets. When writing your backend and frontend in the same repository, it can be easy to accidentally import sensitive data into your front-end code (environment variables containing API keys, for example). SvelteKit provides a way to prevent this entirely: server-only modules.\n\n## Private environment variables\n\nThe [`$env/static/private`]($env-static-private) and [`$env/dynamic/private`]($env-dynamic-private) modules can only be imported into modules that only run on the server, such as [`hooks.server.js`](hooks#Server-hooks) or [`+page.server.js`](routing#page-page.server.js).\n\n## Server-only utilities\n\nThe [`$app/server`]($app-server) module, which contains a [`read`]($app-server#read) function for reading assets from the filesystem, can likewise only be imported by code that runs on the server.\n\n## Your modules\n\nYou can make your own modules server-only in two ways:\n\n- adding `.server` to the filename, e.g. `secrets.server.js`\n- placing them in `$lib/server`, e.g. `$lib/server/secrets.js`\n\n## How it works\n\nAny time you have public-facing code that imports server-only code (whether directly or indirectly)...\n\n```js\n// @errors: 7005\n/// file: $lib/server/secrets.js\nexport const atlantisCoordinates = [/* redacted */];\n```\n\n```js\n// @errors: 2307 7006 7005\n/// file: src/routes/utils.js\nexport { atlantisCoordinates } from '$lib/server/secrets.js';\n\nexport const add = (a, b) => a + b;\n```\n\n```html\n/// file: src/routes/+page.svelte\n\u003Cscript>\n\timport { add } from './utils.js';\n\u003C/script>\n```\n\n...SvelteKit will error:\n\n```\nCannot import $lib/server/secrets.ts into code that runs in the browser, as this could leak sensitive information.\n\n src/routes/+page.svelte imports\n  src/routes/utils.js imports\n   $lib/server/secrets.ts\n\nIf you're only using the import as a type, change it to `import type`.\n```\n\nEven though the public-facing code — `src/routes/+page.svelte` — only uses the `add` export and not the secret `atlantisCoordinates` export, the secret code could end up in JavaScript that the browser downloads, and so the import chain is considered unsafe.\n\nThis feature also works with dynamic imports, even interpolated ones like ``await import(`./${foo}.js`)``.\n\n> [!NOTE] Unit testing frameworks like Vitest do not distinguish between server-only and public-facing code. For this reason, illegal import detection is disabled when running tests, as determined by `process.env.TEST === 'true'`.\n\n## Further reading\n\n- [Tutorial: Environment variables](/tutorial/kit/env-static-private)\n","## Server-only modules\n\nPrevent accidental exposure of sensitive data (API keys, private environment variables) to the browser by marking code as server-only.\n\n### Private environment variables\n\nImport `$env/static/private` and `$env/dynamic/private` only in server-side files like `hooks.server.js` or `+page.server.js`.\n\n### Server utilities\n\nThe `$app/server` module (containing `read()` for filesystem access) can only be imported by server-side code.\n\n### Creating server-only modules\n\nTwo ways to mark your own modules as server-only:\n1. Add `.server` to filename: `secrets.server.js`\n2. Place in `$lib/server/`: `$lib/server/secrets.js`\n\n### How it works\n\nSvelteKit prevents any import chain from public-facing code (like `+page.svelte`) to server-only code, even if only unused exports are imported:\n\n```js\n// $lib/server/secrets.js\nexport const apiKey = 'secret';\n\n// src/routes/utils.js\nexport { apiKey } from '$lib/server/secrets.js';\nexport const add = (a, b) => a + b;\n\n// src/routes/+page.svelte\nimport { add } from './utils.js'; // ERROR: import chain includes server-only code\n```\n\nThis also works with dynamic imports like `` await import(`./${foo}.js`) ``.\n\n**Note:** Unit testing frameworks disable this check when `process.env.TEST === 'true'`.","Mark modules as server-only using `.server` filename suffix or `$lib/server/` directory to prevent sensitive data leaking to the browser. SvelteKit errors if any import chain from client code reaches server-only modules, even indirectly or through unused exports.","Prevent accidental exposure of sensitive data to the browser by marking modules as server-only using .server suffix or $lib/server/ directory."],"uses":{"params":["name","path"]}}]}
